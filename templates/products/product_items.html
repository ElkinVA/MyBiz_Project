{% for product in products %}
<div class="bg-white rounded-lg shadow-md overflow-hidden hover:shadow-lg transition duration-300 group">
    <a href="{{ product.get_absolute_url }}" class="block">
        <div class="relative overflow-hidden">
            {% if product.image %}
            <img src="{{ product.image.url }}"
                 alt="{{ product.name }}"
                 class="w-full h-48 object-cover group-hover:scale-105 transition duration-300">
            {% else %}
            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                <span class="text-gray-400">Нет изображения</span>
            </div>
            {% endif %}

            {% if product.is_new %}
            <span class="absolute top-2 left-2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded">
                NEW
            </span>
            {% endif %}

            {% if product.discount_price %}
            <span class="absolute top-2 right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded">
                -{{ product.get_discount_percentage }}%
            </span>
            {% endif %}
        </div>

        <div class="p-4">
            <h3 class="font-semibold text-lg mb-2 group-hover:text-accent transition">
                {{ product.name }}
            </h3>

            <div class="flex items-center mb-2">
                <span class="text-gray-600 text-sm">
                    {{ product.category.name }}
                </span>
            </div>

            <p class="text-gray-500 text-sm mb-3 line-clamp-2">
                {{ product.short_description|default:'' }}
            </p>

            <div class="flex items-center justify-between">
                <div>
                    {% if product.discount_price %}
                    <span class="text-xl font-bold text-accent">
                        {{ product.discount_price }} ₽
                    </span>
                    <span class="text-gray-400 line-through ml-2">
                        {{ product.price }} ₽
                    </span>
                    {% else %}
                    <span class="text-xl font-bold text-gray-900">
                        {{ product.price }} ₽
                    </span>
                    {% endif %}
                </div>

                {% comment %} <button class="bg-gray-800 text-white p-2 rounded-full hover:bg-gray-900 transition"
                        onclick="event.preventDefault(); addToCart({{ product.id }})">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                    </svg>
                </button> {% endcomment %}
            </div>
        </div>
    </a>
</div>
{% endfor %}
